{"ast":null,"code":"import { FormControl, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/user/services/auth.service\";\nimport * as i2 from \"ngx-cookie-service\";\nimport * as i3 from \"src/app/user/services/user.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"src/app/user/services/progress-bar.service\";\nimport * as i6 from \"src/app/user/services/notify-dialog.service\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"@angular/material/button\";\nimport * as i9 from \"@angular/material/icon\";\nimport * as i10 from \"@angular/material/progress-bar\";\nimport * as i11 from \"@angular/forms\";\n\nfunction ValidOTPComponent_div_0_mat_progress_bar_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-progress-bar\", 26);\n  }\n}\n\nfunction ValidOTPComponent_div_0_div_34_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵtext(1, \"S\\u1ED1 b\\u1EA1n \\u0111\\u00E3 nh\\u1EADp kh\\u00F4ng kh\\u1EDBp v\\u1EDBi m\\u00E3. Vui l\\u00F2ng th\\u1EED l\\u1EA1i.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ValidOTPComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2);\n    i0.ɵɵelement(2, \"div\", 3);\n    i0.ɵɵelementStart(3, \"ul\", 4)(4, \"div\", 5);\n    i0.ɵɵelement(5, \"img\", 6);\n    i0.ɵɵelementStart(6, \"h3\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"li\", 7);\n    i0.ɵɵelement(9, \"i\", 8);\n    i0.ɵɵelementStart(10, \"ul\", 9)(11, \"li\", 10);\n    i0.ɵɵlistener(\"click\", function ValidOTPComponent_div_0_Template_li_click_11_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.onClickLogout());\n    });\n    i0.ɵɵelementStart(12, \"div\", 11)(13, \"div\", 12)(14, \"mat-icon\");\n    i0.ɵɵtext(15, \"exit_to_app\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"div\", 13)(17, \"h4\");\n    i0.ɵɵtext(18, \"Log out\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"div\", 14)(20, \"mat-icon\");\n    i0.ɵɵtext(21, \"keyboard_arrow_right\");\n    i0.ɵɵelementEnd()()()()()()();\n    i0.ɵɵelementStart(22, \"div\", 15);\n    i0.ɵɵtemplate(23, ValidOTPComponent_div_0_mat_progress_bar_23_Template, 1, 0, \"mat-progress-bar\", 16);\n    i0.ɵɵpipe(24, \"async\");\n    i0.ɵɵelementStart(25, \"div\", 17)(26, \"div\", 18)(27, \"h1\");\n    i0.ɵɵtext(28, \"Nh\\u1EADp m\\u00E3 x\\u00E1c nh\\u1EADn\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(29, \"div\", 19)(30, \"p\");\n    i0.ɵɵtext(31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"div\", 20);\n    i0.ɵɵelement(33, \"input\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(34, ValidOTPComponent_div_0_div_34_Template, 2, 0, \"div\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(35, \"div\", 23)(36, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ValidOTPComponent_div_0_Template_button_click_36_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.onClickCancel());\n    });\n    i0.ɵɵtext(37, \"H\\u1EE7y\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(38, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function ValidOTPComponent_div_0_Template_button_click_38_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.validOTP());\n    });\n    i0.ɵɵtext(39, \"Ti\\u1EBFp theo\");\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(ctx_r0.userProfile.fullName);\n    i0.ɵɵadvance(16);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(24, 6, ctx_r0.progressBarService.progressBar$));\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate1(\" \\u0110\\u1EC3 x\\u00E1c nh\\u1EADn t\\u00E0i kho\\u1EA3n c\\u1EE7a b\\u1EA1n, h\\u00E3y nh\\u1EADp m\\u00E3 g\\u1ED3m 6 ch\\u1EEF s\\u1ED1 m\\u00E0 ch\\u00FAng t\\u00F4i \\u0111\\u00E3 g\\u1EEDi \\u0111\\u1EBFn: \", ctx_r0.userProfile.email, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formControl\", ctx_r0.OTPCtrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isWrongCode);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.OTPCtrl.invalid);\n  }\n}\n\nexport class ValidOTPComponent {\n  constructor(authService, cookieService, userService, router, progressBarService, activatedRoute, notifyDialogService) {\n    this.authService = authService;\n    this.cookieService = cookieService;\n    this.userService = userService;\n    this.router = router;\n    this.progressBarService = progressBarService;\n    this.activatedRoute = activatedRoute;\n    this.notifyDialogService = notifyDialogService;\n    this.OTPCtrl = new FormControl('', [Validators.required]);\n    this.isWrongCode = false;\n    this.routerPath = this.activatedRoute.routeConfig?.path;\n    this.sourcePath = this.activatedRoute.snapshot.queryParams.sPath;\n\n    if (this.routerPath === 'confirmemail') {\n      let userId = cookieService.get('c-user');\n\n      if (userId) {\n        userService.findByUserId(Number.parseInt(userId)).subscribe(response => {\n          this.userProfile = response;\n        });\n      } else {\n        router.navigate(['/login']);\n      }\n    } else if (this.routerPath === 'recover/code') {\n      let userId = this.activatedRoute.snapshot.queryParams['uid'];\n\n      if (userId) {\n        userService.findByUserId(userId).subscribe(response => {\n          this.userProfile = response;\n        });\n      } else {\n        if (this.sourcePath === \"user-login\") {\n          this.router.navigate(['/login']);\n        } else if (this.sourcePath === \"admin-login\") {\n          this.router.navigate(['/administrator-login']);\n        } else {\n          this.router.navigate(['/login']);\n        }\n      }\n    }\n  }\n\n  onClickCancel() {\n    if (this.routerPath === \"confirmemail\") {\n      this.cookieService.delete('c-user', '/');\n      this.router.navigate(['/']);\n    } else if (this.routerPath === 'recover/code') {\n      if (this.sourcePath === 'admin-login') {\n        this.router.navigate(['/administrator-login']);\n      } else if (this.sourcePath === 'user-login') {\n        this.router.navigate(['/login']);\n      }\n    }\n  }\n\n  ngOnInit() {\n    this.OTPCtrl.valueChanges.subscribe(v => {\n      this.isWrongCode = false;\n    });\n  }\n\n  ngOnDestroy() {\n    if (this.routerPath === 'recover/code') {\n      let userId = this.cookieService.get('c-user');\n\n      if (userId) {\n        this.cookieService.delete('c-user', '/');\n      }\n    }\n  }\n\n  validOTP() {\n    let OTPValue = this.OTPCtrl.value;\n    let userId = -1;\n\n    if (this.routerPath === 'confirmemail') {\n      userId = Number.parseInt(this.cookieService.get(\"c-user\"));\n    } else if (this.routerPath === 'recover/code') {\n      userId = this.userProfile.id;\n    }\n\n    this.authService.validOTP(OTPValue + '', userId).subscribe(response => {\n      let data = response.data;\n\n      if (response.message == 'SUCCESS') {\n        this.authService.JWTBSub.next(data.jwt);\n        this.userService.userBSub.next(data.user);\n        this.cookieService.delete('c-user', '/');\n\n        if (this.routerPath === 'confirmemail') {\n          this.notifyDialogService.open('Xác thực thành công', 'Tiến hành đổi mật khẩu mới của bạn', [['/home', 'Trở về trang chủ']]);\n        } else if (this.routerPath === 'recover/code') {\n          this.router.navigate(['recover/password'], {\n            queryParams: {\n              uid: this.userProfile.id,\n              code: OTPValue,\n              sPath: this.sourcePath\n            }\n          });\n        }\n      }\n    }, errorResponse => {\n      let message = errorResponse.error.message;\n\n      if (message === 'FAILED') {\n        this.isWrongCode = true;\n      }\n    });\n  }\n\n  onClickLogout() {\n    this.cookieService.delete('c-user', '/');\n\n    if (this.sourcePath === 'admin-login') {\n      this.router.navigate(['/administrator-login']);\n    } else if (this.sourcePath === 'user-login') {\n      this.router.navigate(['/login']);\n    } else {\n      this.router.navigate(['/login']);\n    }\n  }\n\n}\n\nValidOTPComponent.ɵfac = function ValidOTPComponent_Factory(t) {\n  return new (t || ValidOTPComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.CookieService), i0.ɵɵdirectiveInject(i3.UserService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.ProgressBarService), i0.ɵɵdirectiveInject(i4.ActivatedRoute), i0.ɵɵdirectiveInject(i6.NotifyDialogService));\n};\n\nValidOTPComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ValidOTPComponent,\n  selectors: [[\"app-valid-otp\"]],\n  decls: 1,\n  vars: 1,\n  consts: [[\"class\", \"grid\", 4, \"ngIf\"], [1, \"grid\"], [1, \"row\", \"no-gutters\", \"header\", \"align-item-center\", \"justify-content-between\"], [1, \"header__logo\", \"col\"], [1, \"login-form__list\", \"d-flex\", \"align-items-center\"], [1, \"profile__item\"], [\"src\", \"assets/image/profile-pic.png\", \"alt\", \"\"], [1, \"more-option-btn\", \"login-form__item\", \"d-flex\", \"align-items-center\"], [1, \"fa-solid\", \"fa-sort-down\", \"d-flex\", \"align-items-center\"], [1, \"notification\", \"hidden\"], [3, \"click\"], [1, \"notification__left\"], [1, \"notification__left-wrapper\"], [1, \"notification__main\"], [1, \"notification__right\"], [1, \"row\", \"no-gutters\", \"main\", \"d-flex\", \"justify-content-center\", \"align-items-center\"], [\"mode\", \"indeterminate\", 4, \"ngIf\"], [1, \"find-account\"], [1, \"find-account__header\", \"d-flex\", \"align-items-center\"], [1, \"find-account__main\"], [1, \"field\"], [\"type\", \"number\", \"placeholder\", \"6-digit code\", 3, \"formControl\"], [\"class\", \"mr-l-5\", \"style\", \"color: var(--base-cherry-color--)\", 4, \"ngIf\"], [1, \"find-account__footer\", \"d-flex\", \"align-items-center\", \"justify-content-end\"], [\"mat-raised-button\", \"\", 3, \"click\"], [\"mat-raised-button\", \"\", 1, \"primary-btn\", 3, \"disabled\", \"click\"], [\"mode\", \"indeterminate\"], [1, \"mr-l-5\", 2, \"color\", \"var(--base-cherry-color--)\"]],\n  template: function ValidOTPComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, ValidOTPComponent_div_0_Template, 40, 8, \"div\", 0);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.userProfile);\n    }\n  },\n  dependencies: [i7.NgIf, i8.MatButton, i9.MatIcon, i10.MatProgressBar, i11.DefaultValueAccessor, i11.NumberValueAccessor, i11.NgControlStatus, i11.FormControlDirective, i7.AsyncPipe],\n  styles: [\".header[_ngcontent-%COMP%] {\\n  height: 60px;\\n  position: sticky;\\n  top: 0;\\n  box-shadow: 0 0 5px #ccc;\\n  padding: 5px;\\n  z-index: 9999;\\n}\\n\\n.header[_ngcontent-%COMP%]   .header__logo[_ngcontent-%COMP%] {\\n  min-width: 200px;\\n}\\n\\n.header[_ngcontent-%COMP%]   .login-form__list[_ngcontent-%COMP%]   .more-option-btn[_ngcontent-%COMP%]::before {\\n  position: absolute;\\n  content: \\\"\\\";\\n  top: 100%;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n.header[_ngcontent-%COMP%]   .login-form__list[_ngcontent-%COMP%]   .more-option-btn[_ngcontent-%COMP%]:hover   .notification[_ngcontent-%COMP%] {\\n  display: block;\\n}\\n\\n.header[_ngcontent-%COMP%]   .login-form__item[_ngcontent-%COMP%] {\\n  border-radius: 50%;\\n  background: rgba(24, 127, 242, 0.2);\\n  width: 40px;\\n  height: 40px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  position: relative;\\n}\\n\\n.header[_ngcontent-%COMP%]   .login-form__item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] {\\n  color: var(--primary-color--);\\n  position: absolute;\\n  font-size: 2rem;\\n  top: 5px;\\n}\\n\\n.login-form__list[_ngcontent-%COMP%]   .profile__item[_ngcontent-%COMP%] {\\n  border-radius: 30px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  height: 100%;\\n  padding: 0 5px;\\n}\\n\\n.login-form__list[_ngcontent-%COMP%]   .profile__item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n  width: 35px;\\n  height: 35px;\\n  border-radius: 100rem;\\n}\\n\\n.login-form__list[_ngcontent-%COMP%]   .profile__item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\n  font-weight: 550;\\n  margin: 0 5px;\\n  font-size: 1.4rem;\\n  letter-spacing: 1px;\\n}\\n\\n.main[_ngcontent-%COMP%] {\\n  height: calc(100vh - 60px);\\n  background-color: rgb(233, 235, 238);\\n}\\n\\n.main[_ngcontent-%COMP%]   .find-account[_ngcontent-%COMP%] {\\n  max-width: 500px;\\n  height: 275px;\\n  box-shadow: 0 0 5px #ccc;\\n  border-radius: 5px;\\n  background-color: var(--white-color--);\\n}\\n\\n.main[_ngcontent-%COMP%]   .find-account__header[_ngcontent-%COMP%] {\\n  height: 60px;\\n  padding: 10px;\\n}\\n\\n.main[_ngcontent-%COMP%]   .find-account__header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%] {\\n  margin: auto 0;\\n}\\n\\n.main[_ngcontent-%COMP%]   .find-account__main[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: space-around;\\n  padding: 10px;\\n  height: calc(100% - 60px - 70px);\\n  border-top: 1px solid #ccc;\\n  border-bottom: 1px solid #ccc;\\n}\\n\\n.main[_ngcontent-%COMP%]   .find-account__footer[_ngcontent-%COMP%] {\\n  height: 70px;\\n}\\n\\n.main[_ngcontent-%COMP%]   .find-account__footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  margin: 0 10px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZhbGlkLW90cC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFlBQUE7RUFDQSxnQkFBQTtFQUNBLE1BQUE7RUFDQSx3QkFBQTtFQUNBLFlBQUE7RUFDQSxhQUFBO0FBQ0o7O0FBRUE7RUFDSSxnQkFBQTtBQUNKOztBQUdBO0VBQ0ksa0JBQUE7RUFDQSxXQUFBO0VBQ0EsU0FBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0FBQUo7O0FBRUE7RUFDSSxjQUFBO0FBQ0o7O0FBRUE7RUFDSSxrQkFBQTtFQUNBLG1DQUFBO0VBQ0EsV0FBQTtFQUNBLFlBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtFQUNBLGtCQUFBO0FBQ0o7O0FBRUE7RUFDSSw2QkFBQTtFQUNBLGtCQUFBO0VBQ0EsZUFBQTtFQUNBLFFBQUE7QUFDSjs7QUFFQTtFQUNJLG1CQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0VBQ0EsOEJBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtBQUNKOztBQUVBO0VBQ0ksV0FBQTtFQUNBLFlBQUE7RUFDQSxxQkFBQTtBQUNKOztBQUVBO0VBQ0ksZ0JBQUE7RUFDQSxhQUFBO0VBQ0EsaUJBQUE7RUFDQSxtQkFBQTtBQUNKOztBQUVBO0VBQ0ksMEJBQUE7RUFDQSxvQ0FBQTtBQUNKOztBQUVBO0VBQ0ksZ0JBQUE7RUFDQSxhQUFBO0VBQ0Esd0JBQUE7RUFDQSxrQkFBQTtFQUNBLHNDQUFBO0FBQ0o7O0FBRUE7RUFDSSxZQUFBO0VBQ0EsYUFBQTtBQUNKOztBQUVBO0VBQ0ksY0FBQTtBQUNKOztBQUVBO0VBQ0ksYUFBQTtFQUNBLHNCQUFBO0VBQ0EsNkJBQUE7RUFDQSxhQUFBO0VBQ0EsZ0NBQUE7RUFDQSwwQkFBQTtFQUNBLDZCQUFBO0FBQ0o7O0FBRUE7RUFDSSxZQUFBO0FBQ0o7O0FBRUE7RUFDSSxjQUFBO0FBQ0oiLCJmaWxlIjoidmFsaWQtb3RwLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmhlYWRlciB7XHJcbiAgICBoZWlnaHQ6IDYwcHg7XHJcbiAgICBwb3NpdGlvbjogc3RpY2t5O1xyXG4gICAgdG9wOiAwO1xyXG4gICAgYm94LXNoYWRvdzogMCAwIDVweCAjY2NjO1xyXG4gICAgcGFkZGluZzogNXB4O1xyXG4gICAgei1pbmRleDogOTk5OTtcclxufSAgXHJcblxyXG4uaGVhZGVyIC5oZWFkZXJfX2xvZ28ge1xyXG4gICAgbWluLXdpZHRoOiAyMDBweDtcclxufVxyXG5cclxuLmhlYWRlciAubG9naW4tZm9ybV9fbGlzdCB7fVxyXG4uaGVhZGVyIC5sb2dpbi1mb3JtX19saXN0IC5tb3JlLW9wdGlvbi1idG46OmJlZm9yZXtcclxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgIGNvbnRlbnQ6ICcnO1xyXG4gICAgdG9wOiAxMDAlO1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbn1cclxuLmhlYWRlciAubG9naW4tZm9ybV9fbGlzdCAubW9yZS1vcHRpb24tYnRuOmhvdmVyIC5ub3RpZmljYXRpb257XHJcbiAgICBkaXNwbGF5OiBibG9jaztcclxufVxyXG5cclxuLmhlYWRlciAubG9naW4tZm9ybV9faXRlbSB7XHJcbiAgICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbiAgICBiYWNrZ3JvdW5kOiByZ2JhKDI0LCAxMjcsIDI0MiwgMC4yKTtcclxuICAgIHdpZHRoOiA0MHB4O1xyXG4gICAgaGVpZ2h0OiA0MHB4O1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxufVxyXG5cclxuLmhlYWRlciAubG9naW4tZm9ybV9faXRlbSBpIHtcclxuICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWNvbG9yLS0pO1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgZm9udC1zaXplOiAycmVtO1xyXG4gICAgdG9wOiA1cHg7XHJcbn1cclxuXHJcbi5sb2dpbi1mb3JtX19saXN0IC5wcm9maWxlX19pdGVtIHtcclxuICAgIGJvcmRlci1yYWRpdXM6IDMwcHg7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxuICAgIGhlaWdodDogMTAwJTtcclxuICAgIHBhZGRpbmc6IDAgNXB4O1xyXG59XHJcblxyXG4ubG9naW4tZm9ybV9fbGlzdCAucHJvZmlsZV9faXRlbSBpbWcge1xyXG4gICAgd2lkdGg6IDM1cHg7XHJcbiAgICBoZWlnaHQ6IDM1cHg7XHJcbiAgICBib3JkZXItcmFkaXVzOiAxMDByZW07XHJcbn1cclxuXHJcbi5sb2dpbi1mb3JtX19saXN0IC5wcm9maWxlX19pdGVtIGgzIHtcclxuICAgIGZvbnQtd2VpZ2h0OiA1NTA7XHJcbiAgICBtYXJnaW46IDAgNXB4O1xyXG4gICAgZm9udC1zaXplOiAxLjRyZW07XHJcbiAgICBsZXR0ZXItc3BhY2luZzogMXB4O1xyXG59XHJcblxyXG4ubWFpbiB7XHJcbiAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA2MHB4KTtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyMzMsIDIzNSwgMjM4KTtcclxufVxyXG5cclxuLm1haW4gLmZpbmQtYWNjb3VudCB7XHJcbiAgICBtYXgtd2lkdGg6IDUwMHB4O1xyXG4gICAgaGVpZ2h0OiAyNzVweDtcclxuICAgIGJveC1zaGFkb3c6IDAgMCA1cHggI2NjYztcclxuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXdoaXRlLWNvbG9yLS0pO1xyXG59XHJcblxyXG4ubWFpbiAuZmluZC1hY2NvdW50X19oZWFkZXIge1xyXG4gICAgaGVpZ2h0OiA2MHB4O1xyXG4gICAgcGFkZGluZzogMTBweDtcclxufVxyXG5cclxuLm1haW4gLmZpbmQtYWNjb3VudF9faGVhZGVyIGgxIHtcclxuICAgIG1hcmdpbjogYXV0byAwO1xyXG59XHJcblxyXG4ubWFpbiAuZmluZC1hY2NvdW50X19tYWluIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XHJcbiAgICBwYWRkaW5nOiAxMHB4O1xyXG4gICAgaGVpZ2h0OiBjYWxjKDEwMCUgLSA2MHB4IC0gNzBweCk7XHJcbiAgICBib3JkZXItdG9wOiAxcHggc29saWQgI2NjYztcclxuICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjY2NjO1xyXG59XHJcblxyXG4ubWFpbiAuZmluZC1hY2NvdW50X19mb290ZXIge1xyXG4gICAgaGVpZ2h0OiA3MHB4XHJcbn1cclxuXHJcbi5tYWluIC5maW5kLWFjY291bnRfX2Zvb3RlciBidXR0b24ge1xyXG4gICAgbWFyZ2luOiAwIDEwcHhcclxufSJdfQ== */\"]\n});","map":{"version":3,"mappings":"AACA,SAASA,WAAT,EAAsBC,UAAtB,QAAwC,gBAAxC;;;;;;;;;;;;;;;;IC6BQC;;;;;;IAaQA;IAAkFA;IAAmDA;;;;;;;;IA3CrJA,+BAAsC,CAAtC,EAAsC,KAAtC,EAAsC,CAAtC;IAEQA;IACAA,8BAAuD,CAAvD,EAAuD,KAAvD,EAAuD,CAAvD;IAEQA;IACAA;IAAIA;IAAwBA;IAEhCA;IACIA;IACAA,+BAAgC,EAAhC,EAAgC,IAAhC,EAAgC,EAAhC;IAEQA;MAAAA;MAAA;MAAA,OAASA,sCAAT;IAAwB,CAAxB;IACAA,iCAAgC,EAAhC,EAAgC,KAAhC,EAAgC,EAAhC,EAAgC,EAAhC,EAAgC,UAAhC;IAEkBA;IAAWA;IAG7BA,iCAAgC,EAAhC,EAAgC,IAAhC;IACQA;IAAOA;IAEfA,iCAAiC,EAAjC,EAAiC,UAAjC;IACcA;IAAoBA;IAOtDA;IACIA;;IACAA,iCAA0B,EAA1B,EAA0B,KAA1B,EAA0B,EAA1B,EAA0B,EAA1B,EAA0B,IAA1B;IAEYA;IAAgBA;IAExBA,iCAAgC,EAAhC,EAAgC,GAAhC;IAEQA;IAEJA;IACAA;IACIA;IACJA;IACAA;IACJA;IACAA,iCAAgF,EAAhF,EAAgF,QAAhF,EAAgF,EAAhF;IAC8BA;MAAAA;MAAA;MAAA,OAASA,sCAAT;IAAwB,CAAxB;IAA0BA;IAAGA;IACvDA;IAA2EA;MAAAA;MAAA;MAAA,OAASA,iCAAT;IAAmB,CAAnB;IAAqBA;IAASA;;;;;IAzCrGA;IAAAA;IAwBOA;IAAAA;IAOPA;IAAAA;IAIgDA;IAAAA;IAE9CA;IAAAA;IAIwCA;IAAAA;;;;AD7B9D,OAAM,MAAOC,iBAAP,CAAwB;EAM5BC,YACUC,WADV,EAEUC,aAFV,EAGUC,WAHV,EAIUC,MAJV,EAKSC,kBALT,EAMUC,cANV,EAOUC,mBAPV,EAOkD;IANxC;IACA;IACA;IACA;IACD;IACC;IACA;IAXV,eAAuB,IAAIX,WAAJ,CAAgB,EAAhB,EAAoB,CAACC,UAAU,CAACW,QAAZ,CAApB,CAAvB;IAGA,mBAAuB,KAAvB;IAUE,KAAKC,UAAL,GAAkB,KAAKH,cAAL,CAAoBI,WAApB,EAAiCC,IAAnD;IACA,KAAKC,UAAL,GAAkB,KAAKN,cAAL,CAAoBO,QAApB,CAA6BC,WAA7B,CAAyCC,KAA3D;;IACA,IAAI,KAAKN,UAAL,KAAoB,cAAxB,EAAwC;MACtC,IAAIO,MAAM,GAAGd,aAAa,CAACe,GAAd,CAAkB,QAAlB,CAAb;;MACA,IAAID,MAAJ,EAAY;QACVb,WAAW,CACRe,YADH,CACgBC,MAAM,CAACC,QAAP,CAAgBJ,MAAhB,CADhB,EAEGK,SAFH,CAEcC,QAAD,IAAa;UACtB,KAAKC,WAAL,GAAmBD,QAAnB;QACD,CAJH;MAKD,CAND,MAMO;QACLlB,MAAM,CAACoB,QAAP,CAAgB,CAAC,QAAD,CAAhB;MACD;IACF,CAXD,MAWO,IAAI,KAAKf,UAAL,KAAoB,cAAxB,EAAwC;MAC7C,IAAIO,MAAM,GAAG,KAAKV,cAAL,CAAoBO,QAApB,CAA6BC,WAA7B,CAAyC,KAAzC,CAAb;;MACA,IAAIE,MAAJ,EAAY;QACVb,WAAW,CAACe,YAAZ,CAAyBF,MAAzB,EAAiCK,SAAjC,CAA4CC,QAAD,IAAa;UACtD,KAAKC,WAAL,GAAmBD,QAAnB;QACD,CAFD;MAGD,CAJD,MAIM;QACJ,IAAG,KAAKV,UAAL,KAAoB,YAAvB,EAAoC;UAClC,KAAKR,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,QAAD,CAArB;QACD,CAFD,MAEM,IAAG,KAAKZ,UAAL,KAAoB,aAAvB,EAAqC;UACzC,KAAKR,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,sBAAD,CAArB;QACD,CAFK,MAED;UACH,KAAKpB,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,QAAD,CAArB;QACD;MACF;IACF;EACF;;EACDC,aAAa;IACX,IAAG,KAAKhB,UAAL,KAAoB,cAAvB,EAAsC;MACpC,KAAKP,aAAL,CAAmBwB,MAAnB,CAA0B,QAA1B,EAAoC,GAApC;MACA,KAAKtB,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,GAAD,CAArB;IACD,CAHD,MAGM,IAAG,KAAKf,UAAL,KAAoB,cAAvB,EAAsC;MAC1C,IAAG,KAAKG,UAAL,KAAoB,aAAvB,EAAqC;QACnC,KAAKR,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,sBAAD,CAArB;MACD,CAFD,MAEM,IAAG,KAAKZ,UAAL,KAAoB,YAAvB,EAAoC;QACxC,KAAKR,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,QAAD,CAArB;MACD;IACF;EACF;;EAEDG,QAAQ;IACN,KAAKC,OAAL,CAAaC,YAAb,CAA0BR,SAA1B,CAAqCS,CAAD,IAAM;MACxC,KAAKC,WAAL,GAAmB,KAAnB;IACD,CAFD;EAGD;;EACDC,WAAW;IACT,IAAI,KAAKvB,UAAL,KAAoB,cAAxB,EAAwC;MACtC,IAAIO,MAAM,GAAG,KAAKd,aAAL,CAAmBe,GAAnB,CAAuB,QAAvB,CAAb;;MACA,IAAID,MAAJ,EAAY;QACV,KAAKd,aAAL,CAAmBwB,MAAnB,CAA0B,QAA1B,EAAoC,GAApC;MACD;IACF;EACF;;EAEDO,QAAQ;IACN,IAAIC,QAAQ,GAAG,KAAKN,OAAL,CAAaO,KAA5B;IACA,IAAInB,MAAM,GAAG,CAAC,CAAd;;IACA,IAAG,KAAKP,UAAL,KAAoB,cAAvB,EAAsC;MACpCO,MAAM,GAAGG,MAAM,CAACC,QAAP,CAAgB,KAAKlB,aAAL,CAAmBe,GAAnB,CAAuB,QAAvB,CAAhB,CAAT;IACD,CAFD,MAEM,IAAG,KAAKR,UAAL,KAAoB,cAAvB,EAAsC;MAC1CO,MAAM,GAAG,KAAKO,WAAL,CAAiBa,EAA1B;IACD;;IACD,KAAKnC,WAAL,CAAiBgC,QAAjB,CAA0BC,QAAQ,GAAG,EAArC,EAAyClB,MAAzC,EAAiDK,SAAjD,CACGC,QAAD,IAAa;MACX,IAAIe,IAAI,GAA2Bf,QAAQ,CAACe,IAA5C;;MACA,IAAIf,QAAQ,CAACgB,OAAT,IAAoB,SAAxB,EAAmC;QACjC,KAAKrC,WAAL,CAAiBsC,OAAjB,CAAyBC,IAAzB,CAA8BH,IAAI,CAACI,GAAnC;QACA,KAAKtC,WAAL,CAAiBuC,QAAjB,CAA0BF,IAA1B,CAA+BH,IAAI,CAACM,IAApC;QACA,KAAKzC,aAAL,CAAmBwB,MAAnB,CAA0B,QAA1B,EAAoC,GAApC;;QACA,IAAI,KAAKjB,UAAL,KAAoB,cAAxB,EAAwC;UACtC,KAAKF,mBAAL,CAAyBqC,IAAzB,CACE,qBADF,EAEE,oCAFF,EAGE,CAAC,CAAC,OAAD,EAAU,kBAAV,CAAD,CAHF;QAKD,CAND,MAMO,IAAI,KAAKnC,UAAL,KAAoB,cAAxB,EAAwC;UAC7C,KAAKL,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,kBAAD,CAArB,EAA2C;YACzCV,WAAW,EAAE;cACX+B,GAAG,EAAE,KAAKtB,WAAL,CAAiBa,EADX;cAEXU,IAAI,EAAEZ,QAFK;cAGXnB,KAAK,EAAE,KAAKH;YAHD;UAD4B,CAA3C;QAOD;MACF;IACF,CAvBH,EAwBGmC,aAAD,IAAkB;MAChB,IAAIT,OAAO,GAAGS,aAAa,CAACC,KAAd,CAAoBV,OAAlC;;MACA,IAAIA,OAAO,KAAK,QAAhB,EAA0B;QACxB,KAAKP,WAAL,GAAmB,IAAnB;MACD;IACF,CA7BH;EA+BD;;EACDkB,aAAa;IACX,KAAK/C,aAAL,CAAmBwB,MAAnB,CAA0B,QAA1B,EAAoC,GAApC;;IACA,IAAG,KAAKd,UAAL,KAAoB,aAAvB,EAAqC;MACnC,KAAKR,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,sBAAD,CAArB;IACD,CAFD,MAEM,IAAG,KAAKZ,UAAL,KAAoB,YAAvB,EAAoC;MACxC,KAAKR,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,QAAD,CAArB;IACD,CAFK,MAED;MACH,KAAKpB,MAAL,CAAYoB,QAAZ,CAAqB,CAAC,QAAD,CAArB;IACD;EACF;;AAzH2B;;;mBAAjBzB,mBAAiBD;AAAA;;;QAAjBC;EAAiBmD;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MClB9BxD;;;;MAAmBA","names":["FormControl","Validators","i0","ValidOTPComponent","constructor","authService","cookieService","userService","router","progressBarService","activatedRoute","notifyDialogService","required","routerPath","routeConfig","path","sourcePath","snapshot","queryParams","sPath","userId","get","findByUserId","Number","parseInt","subscribe","response","userProfile","navigate","onClickCancel","delete","ngOnInit","OTPCtrl","valueChanges","v","isWrongCode","ngOnDestroy","validOTP","OTPValue","value","id","data","message","JWTBSub","next","jwt","userBSub","user","open","uid","code","errorResponse","error","onClickLogout","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["E:\\Angular\\Travel-DATN\\travel-angular\\src\\app\\components\\valid-otp\\valid-otp.component.ts","E:\\Angular\\Travel-DATN\\travel-angular\\src\\app\\components\\valid-otp\\valid-otp.component.html"],"sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormControl, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { CookieService } from 'ngx-cookie-service';\nimport {\n  AuthenticationResponse,\n  UserProfileResponse\n} from 'src/app/shared/models/response';\nimport { AuthService } from 'src/app/user/services/auth.service';\nimport { NotifyDialogService } from 'src/app/user/services/notify-dialog.service';\nimport { ProgressBarService } from 'src/app/user/services/progress-bar.service';\nimport { UserService } from 'src/app/user/services/user.service';\n\n@Component({\n  selector: 'app-valid-otp',\n  templateUrl: './valid-otp.component.html',\n  styleUrls: ['./valid-otp.component.scss'],\n})\nexport class ValidOTPComponent implements OnInit, OnDestroy {\n  userProfile!: UserProfileResponse;\n  OTPCtrl: FormControl = new FormControl('', [Validators.required]);\n  routerPath: string | undefined;\n  sourcePath!: string\n  isWrongCode: boolean = false; \n  constructor(\n    private authService: AuthService,\n    private cookieService: CookieService,\n    private userService: UserService,\n    private router: Router,\n    public progressBarService: ProgressBarService,\n    private activatedRoute: ActivatedRoute,\n    private notifyDialogService: NotifyDialogService\n  ) {\n    this.routerPath = this.activatedRoute.routeConfig?.path;\n    this.sourcePath = this.activatedRoute.snapshot.queryParams.sPath\n    if (this.routerPath === 'confirmemail') {\n      let userId = cookieService.get('c-user');\n      if (userId) {\n        userService\n          .findByUserId(Number.parseInt(userId))\n          .subscribe((response) => {\n            this.userProfile = response;\n          });\n      } else {\n        router.navigate(['/login']);\n      }\n    } else if (this.routerPath === 'recover/code') {\n      let userId = this.activatedRoute.snapshot.queryParams['uid'];\n      if (userId) {\n        userService.findByUserId(userId).subscribe((response) => {\n          this.userProfile = response;\n        });\n      }else {\n        if(this.sourcePath === \"user-login\"){\n          this.router.navigate(['/login'])\n        }else if(this.sourcePath === \"admin-login\"){\n          this.router.navigate(['/administrator-login'])\n        }else{\n          this.router.navigate(['/login'])\n        }\n      }\n    }\n  }\n  onClickCancel(){\n    if(this.routerPath === \"confirmemail\"){\n      this.cookieService.delete('c-user', '/');\n      this.router.navigate(['/']);\n    }else if(this.routerPath === 'recover/code'){\n      if(this.sourcePath === 'admin-login'){\n        this.router.navigate(['/administrator-login'])\n      }else if(this.sourcePath === 'user-login'){\n        this.router.navigate(['/login'])\n      }\n    }\n  }\n  \n  ngOnInit(): void {\n    this.OTPCtrl.valueChanges.subscribe((v) => {\n      this.isWrongCode = false;\n    });\n  }\n  ngOnDestroy(): void {\n    if (this.routerPath === 'recover/code') {\n      let userId = this.cookieService.get('c-user');\n      if (userId) {\n        this.cookieService.delete('c-user', '/');\n      }\n    }\n  }\n\n  validOTP() {\n    let OTPValue = this.OTPCtrl.value;\n    let userId = -1\n    if(this.routerPath === 'confirmemail'){\n      userId = Number.parseInt(this.cookieService.get(\"c-user\"))\n    }else if(this.routerPath === 'recover/code'){\n      userId = this.userProfile.id\n    }\n    this.authService.validOTP(OTPValue + '', userId).subscribe(\n      (response) => {\n        let data: AuthenticationResponse = response.data;\n        if (response.message == 'SUCCESS') {\n          this.authService.JWTBSub.next(data.jwt);\n          this.userService.userBSub.next(data.user);\n          this.cookieService.delete('c-user', '/');\n          if (this.routerPath === 'confirmemail') {\n            this.notifyDialogService.open(\n              'Xác thực thành công',\n              'Tiến hành đổi mật khẩu mới của bạn',\n              [['/home', 'Trở về trang chủ']]\n            );\n          } else if (this.routerPath === 'recover/code') {\n            this.router.navigate(['recover/password'], {\n              queryParams: {\n                uid: this.userProfile.id,\n                code: OTPValue,\n                sPath: this.sourcePath\n              },\n            });\n          }\n        }\n      },\n      (errorResponse) => {\n        let message = errorResponse.error.message;\n        if (message === 'FAILED') {\n          this.isWrongCode = true;\n        }\n      }\n    );\n  }\n  onClickLogout() {\n    this.cookieService.delete('c-user', '/');\n    if(this.sourcePath === 'admin-login'){\n      this.router.navigate(['/administrator-login']);\n    }else if(this.sourcePath === 'user-login'){\n      this.router.navigate(['/login']);\n    }else{\n      this.router.navigate(['/login']);\n    }\n  }\n}\n","<div class=\"grid\" *ngIf=\"userProfile\">\n    <div class=\"row no-gutters header align-item-center justify-content-between\">\n        <div class=\"header__logo col\"></div>\n        <ul class=\"login-form__list d-flex align-items-center\">\n            <div class=\"profile__item\">\n                <img src=\"assets/image/profile-pic.png\" alt=\"\">\n                <h3>{{userProfile.fullName}}</h3>\n            </div>\n            <li class=\"more-option-btn login-form__item d-flex align-items-center\">\n                <i class=\"fa-solid fa-sort-down d-flex align-items-center\"></i>\n                <ul class=\"notification hidden\">\n                    <!-- <div class=\"separate-line\"></div> -->\n                    <li (click)=\"onClickLogout()\">\n                        <div class=\"notification__left\">\n                            <div class=\"notification__left-wrapper\">\n                                <mat-icon>exit_to_app</mat-icon>\n                            </div>\n                        </div>\n                        <div class=\"notification__main\">\n                            <h4>Log out</h4>\n                        </div>\n                        <div class=\"notification__right\">\n                            <mat-icon>keyboard_arrow_right</mat-icon>\n                        </div>\n                    </li>\n                </ul>\n            </li>\n        </ul>\n    </div>\n    <div class=\"row no-gutters main d-flex justify-content-center align-items-center\">\n        <mat-progress-bar *ngIf=\"progressBarService.progressBar$ | async\" mode=\"indeterminate\"></mat-progress-bar>\n        <div class=\"find-account\">\n            <div class=\"find-account__header d-flex align-items-center\">\n                <h1>Nhập mã xác nhận</h1>\n            </div>\n            <div class=\"find-account__main\">\n                <p>\n                    Để xác nhận tài khoản của bạn, hãy nhập mã gồm 6 chữ số mà chúng tôi đã gửi đến:\n                    {{userProfile.email}}\n                </p>\n                <div class=\"field\">\n                    <input type=\"number\" placeholder=\"6-digit code\" [formControl]=\"OTPCtrl\"/>\n                </div>\n                <div *ngIf=\"isWrongCode\" class=\"mr-l-5\" style=\"color: var(--base-cherry-color--)\">Số bạn đã nhập không khớp với mã. Vui lòng thử lại.</div>\n            </div>\n            <div class=\"find-account__footer d-flex align-items-center justify-content-end\">\n                <button mat-raised-button (click)=\"onClickCancel()\">Hủy</button>\n                <button mat-raised-button class=\"primary-btn\" [disabled]=\"OTPCtrl.invalid\" (click)=\"validOTP()\">Tiếp theo</button>\n            </div>\n        </div>\n    </div>\n</div>"]},"metadata":{},"sourceType":"module"}