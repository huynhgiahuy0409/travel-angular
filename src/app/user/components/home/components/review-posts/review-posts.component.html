<router-outlet></router-outlet>
<div class="main-content search-results" infinite-scroll [scrollWindow]="false" (scrolled)="onScrollDown($event)"
    (scrolledUp)="onScrollUp($event)" [infiniteScrollThrottle]="1">
    <!-- write-post-container -->
    <div class="box-shadow write-post-container">
        <div class="d-flex align-items-center">
            <img src="assets/image/profile-pic.png" alt="" />
            <input type="text" placeholder="Chia sẽ trải nghiệm, blog..." (click)="openCreatePostDialog()" />
        </div>
        <div class="separate-line"></div>
        <ul class="write-post-container__icons">
            <li class="write-post-container__icon">
                <svg fill="currentColor" viewBox="0 0 24 24" width="2.4rem" height="2.4rem"
                    class="write-post-container__icon--cherry-color">
                    <g fill-rule="evenodd" transform="translate(-444 -156)">
                        <g>
                            <path
                                d="M113.029 2.514c-.363-.088-.746.014-1.048.234l-2.57 1.88a.999.999 0 0 0-.411.807v8.13a1 1 0 0 0 .41.808l2.602 1.901c.219.16.477.242.737.242.253 0 .508-.077.732-.235.34-.239.519-.65.519-1.065V3.735a1.25 1.25 0 0 0-.971-1.22m-20.15 6.563c.1-.146 2.475-3.578 5.87-3.578 3.396 0 5.771 3.432 5.87 3.578a.749.749 0 0 1 0 .844c-.099.146-2.474 3.578-5.87 3.578-3.395 0-5.77-3.432-5.87-3.578a.749.749 0 0 1 0-.844zM103.75 19a3.754 3.754 0 0 0 3.75-3.75V3.75A3.754 3.754 0 0 0 103.75 0h-10A3.754 3.754 0 0 0 90 3.75v11.5A3.754 3.754 0 0 0 93.75 19h10z"
                                transform="translate(354 158.5)"></path>
                            <path
                                d="M98.75 12c1.379 0 2.5-1.121 2.5-2.5S100.129 7 98.75 7a2.503 2.503 0 0 0-2.5 2.5c0 1.379 1.121 2.5 2.5 2.5"
                                transform="translate(354 158.5)"></path>
                        </g>
                    </g>
                </svg>
                <p>Live video</p>
            </li>
            <li class="write-post-container__icon">
                <svg fill="currentColor" viewBox="0 0 24 24" width="2.4rem" height="2.4rem"
                    class="write-post-container__icon--lime-color">
                    <g fill-rule="evenodd" transform="translate(-444 -156)">
                        <g>
                            <path
                                d="m96.968 22.425-.648.057a2.692 2.692 0 0 1-1.978-.625 2.69 2.69 0 0 1-.96-1.84L92.01 4.32a2.702 2.702 0 0 1 .79-2.156c.47-.472 1.111-.731 1.774-.79l2.58-.225a.498.498 0 0 1 .507.675 4.189 4.189 0 0 0-.251 1.11L96.017 18.85a4.206 4.206 0 0 0 .977 3.091s.459.364-.026.485m8.524-16.327a1.75 1.75 0 1 1-3.485.305 1.75 1.75 0 0 1 3.485-.305m5.85 3.011a.797.797 0 0 0-1.129-.093l-3.733 3.195a.545.545 0 0 0-.062.765l.837.993a.75.75 0 1 1-1.147.966l-2.502-2.981a.797.797 0 0 0-1.096-.12L99 14.5l-.5 4.25c-.06.674.326 2.19 1 2.25l11.916 1.166c.325.026 1-.039 1.25-.25.252-.21.89-.842.917-1.166l.833-8.084-3.073-3.557z"
                                transform="translate(352 156.5)"></path>
                            <path fill-rule="nonzero"
                                d="m111.61 22.963-11.604-1.015a2.77 2.77 0 0 1-2.512-2.995L98.88 3.09A2.77 2.77 0 0 1 101.876.58l11.603 1.015a2.77 2.77 0 0 1 2.513 2.994l-1.388 15.862a2.77 2.77 0 0 1-2.994 2.513zm.13-1.494.082.004a1.27 1.27 0 0 0 1.287-1.154l1.388-15.862a1.27 1.27 0 0 0-1.148-1.37l-11.604-1.014a1.27 1.27 0 0 0-1.37 1.15l-1.387 15.86a1.27 1.27 0 0 0 1.149 1.37l11.603 1.016z"
                                transform="translate(352 156.5)"></path>
                        </g>
                    </g>
                </svg>
                <p>Photo/video</p>
            </li>
            <li class="write-post-container__icon">
                <svg fill="currentColor" viewBox="0 0 24 24" width="2.4rem" height="2.4rem"
                    class="write-post-container__icon--lemon-color">
                    <g fill-rule="evenodd" transform="translate(-444 -156)">
                        <g>
                            <path
                                d="M107.285 13c.49 0 .841.476.712.957-.623 2.324-2.837 4.043-5.473 4.043-2.636 0-4.85-1.719-5.473-4.043-.13-.48.222-.957.712-.957h9.522z"
                                transform="translate(353.5 156.5)"></path>
                            <path fill-rule="nonzero"
                                d="M114.024 11.5c0 6.351-5.149 11.5-11.5 11.5s-11.5-5.149-11.5-11.5S96.173 0 102.524 0s11.5 5.149 11.5 11.5zm-2 0a9.5 9.5 0 1 0-19 0 9.5 9.5 0 0 0 19 0z"
                                transform="translate(353.5 156.5)"></path>
                            <path
                                d="M99.524 8.5c0 .829-.56 1.5-1.25 1.5s-1.25-.671-1.25-1.5.56-1.5 1.25-1.5 1.25.671 1.25 1.5m8.5 0c0 .829-.56 1.5-1.25 1.5s-1.25-.671-1.25-1.5.56-1.5 1.25-1.5 1.25.671 1.25 1.5m-.739 4.5h-9.522c-.49 0-.841.476-.712.957.623 2.324 2.837 4.043 5.473 4.043 2.636 0 4.85-1.719 5.473-4.043.13-.48-.222-.957-.712-.957m-2.165 2c-.667.624-1.592 1-2.596 1a3.799 3.799 0 0 1-2.596-1h5.192"
                                transform="translate(353.5 156.5)"></path>
                        </g>
                    </g>
                </svg>
                <p>Feeling/activity</p>
            </li>
        </ul>
    </div>
    <form [formGroup]="searchFormGroup" class="journey-search-box box-shadow">
        <i class="fa-solid fa-magnifying-glass" ></i>
        <mat-form-field appearance="fill">
            <mat-label>Tiêu chí tìm kiếm</mat-label>
            <mat-select formControlName="order">
                <mat-option value="title">Tiêu đề bài viết</mat-option>
                <mat-option value="tag">Tag</mat-option>
                <mat-option value="cost">Chi phí chuyến đi</mat-option>
                <mat-option value="provinceName">Tỉnh/Thành phố</mat-option>
            </mat-select>
        </mat-form-field>
        <input type="text" formControlName="search"/>
    </form>
    <!-- posts -->
    <div class="post-container box-shadow" *ngFor="let reviewPost of reviewPosts">
        <!-- header post -->
        <div class="user-profile">
            <img [src]="directLinkService.getDefaultAvatarURL(reviewPost.user.gender)" alt=""
                *ngIf="!reviewPost.user.avt" />
            <div class="user-profile-name">
                <h3>{{ reviewPost.user.fullName }}</h3>
                <div class="d-flex align-items-center">
                    <span>{{ dateTimeFormula(reviewPost.createdDate) }}</span>
                    <mat-icon>public</mat-icon>
                </div>
            </div>
        </div>
        <!-- post content -->
        <div class="post-title">
            {{ reviewPost.title }}
        </div>
        <div class="post-text">
            {{ reviewPost.bio }}
        </div>
        <div class="standard__list" *ngIf="reviewPost.reviewPostTags">
            <div class="standard__item" *ngFor="let tag of reviewPost.reviewPostTags">
                <span style="color: var(--primary-color--)">#{{tag.name}}</span>
            </div>
        </div>
        <!------ Sorting display images ------>
        <div class="review-post__image" (click)="openReviewDetail(reviewPost.id)">
            <!-- 1 image -->
            <div class="image__list one" *ngIf="reviewPost.images.length == 1">
                <div class="image__item">
                    <img [src]="
                    directLinkService.getURLImage(
                reviewPost.user.email,
                reviewPost.images[0].image.name,
                reviewPost.images[0].image.ext
              )
            " alt="" />
                </div>
            </div>
            <!-- 2 images -->
            <div class="image__list two" *ngIf="reviewPost.images.length == 2">
                <div class="row">
                    <div class="col l-6 m-6 c-6" *ngFor="let reviewPostImage of reviewPost.images; index as idx">
                        <div class="image__item">
                            <img [src]="
                  directLinkService.getURLImage(
                    reviewPost.user.email,
                    reviewPostImage.image.name,
                    reviewPostImage.image.ext
                  )
                " alt="" />
                        </div>
                    </div>
                </div>
            </div>
            <!-- 3 images -->
            <div class="image__list three" *ngIf="reviewPost.images.length == 3">
                <div class="row">
                    <ng-container *ngFor="let reviewPostImage of reviewPost.images; index as idx">
                        <div class="col l-12 m-12 c-12" *ngIf="idx === 0">
                            <div class="image__item">
                                <img [src]="
                    directLinkService.getURLImage(
                      reviewPost.user.email,
                      reviewPostImage.image.name,
                      reviewPostImage.image.ext
                    )
                  " alt="" />
                            </div>
                        </div>
                    </ng-container>
                </div>
                <div class="row">
                    <ng-container *ngFor="let reviewPostImage of reviewPost.images; index as idx">
                        <div class="col l-6 m-6 c-6" *ngIf="idx > 0">
                            <div class="image__item">
                                <img [src]="
                    directLinkService.getURLImage(
                      reviewPost.user.email,
                      reviewPostImage.image.name,
                      reviewPostImage.image.ext
                    )
                  " alt="" />
                            </div>
                        </div>
                    </ng-container>
                </div>
            </div>
            <!-- 4 images -->
            <div class="image__list four" *ngIf="reviewPost.images.length == 4">
                <div class="row">
                    <ng-container *ngFor="let reviewPostImage of reviewPost.images; index as idx">
                        <div class="col l-12 m-12 c-12" *ngIf="idx == 0">
                            <div class="image__item">
                                <img [src]="
                    directLinkService.getURLImage(
                      reviewPost.user.email,
                      reviewPostImage.image.name,
                      reviewPostImage.image.ext
                    )
                  " alt="" />
                            </div>
                        </div>
                    </ng-container>
                </div>
                <div class="row">
                    <ng-container *ngFor="let reviewPostImage of reviewPost.images; index as idx">
                        <div class="col l-4 m-4 c-4" *ngIf="idx > 0">
                            <div class="image__item">
                                <img [src]="
                    directLinkService.getURLImage(
                      reviewPost.user.email,
                      reviewPostImage.image.name,
                      reviewPostImage.image.ext
                    )
                  " alt="" />
                            </div>
                        </div>
                    </ng-container>
                </div>
            </div>
            <!-- 5 images -->
            <div class="image__list five" *ngIf="reviewPost.images.length >= 5">
                <div class="row">
                    <ng-container *ngFor="let reviewPostImage of reviewPost.images; index as idx">
                        <div class="col l-6 m-6 c-6" *ngIf="idx >= 0 && idx <= 1">
                            <div class="image__item">
                                <img [src]="
                    directLinkService.getURLImage(
                      reviewPost.user.email,
                      reviewPostImage.image.name,
                      reviewPostImage.image.ext
                    )
                  " alt="" />
                            </div>
                        </div>
                    </ng-container>
                </div>
                <div class="row">
                    <ng-container *ngFor="let reviewPostImage of reviewPost.images; index as idx">
                        <div class="col l-4 m-4 c-4" *ngIf="idx > 1 && idx < 4">
                            <div class="image__item">
                                <img [src]="
                    directLinkService.getURLImage(
                      reviewPost.user.email,
                      reviewPostImage.image.name,
                      reviewPostImage.image.ext
                    )
                  " alt="" />
                            </div>
                        </div>
                    </ng-container>
                    <div class="col l-4 m-4 c-4" *ngIf="reviewPost.images.length == 5">
                        <div class="image__item">
                            <img [src]="
                  directLinkService.getURLImage(
                    reviewPost.user.email,
                    reviewPost.images[4].image.name,
                    reviewPost.images[4].image.ext
                  )
                " alt="" />
                        </div>
                    </div>
                    <div class="col l-4 m-4 c-4" *ngIf="reviewPost.images.length > 5">
                        <div class="image__item" style="position: relative">
                            <img [src]="
                  directLinkService.getURLImage(
                    reviewPost.user.email,
                    reviewPost.images[4].image.name,
                    reviewPost.images[4].image.ext
                  )
                " alt="" />
                            <div class="image__item--overlay">
                                <span>+{{ reviewPost.images.length - 5 }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- post react: like comment shared -->
        <div class="post-react">
            <div class="post-row justify-content-between">
                <div class="post-react-left d-flex">
                    <img style="z-index: 3" src="assets/react-image/like.svg" alt="" />
                    <img style="z-index: 2; margin-left: -5px" src="assets/react-image/love.svg" alt="" />
                    <img style="z-index: 1; margin-left: -5px" src="assets/react-image/care.svg" alt="" />
                    <div class="total-react">55K</div>
                </div>
                <div class="post-react-right d-flex">
                    <div class="">5K Comments</div>
                    <div class="">1.9K Shares</div>
                </div>
            </div>
            <div class="separate-line"></div>
            <ul class="react-btn__list">
                <li #reactBtnItem class="react-btn__item" (click)="unselectReact(reactBtnItem)">
                    <!--         <ng-container *ngTemplateOutlet="reactBtnWrapTemplate">
                </ng-container>
                <ng-template #reactBtnWrapTemplate> -->
                    <div class="react-btn-wrap">
                        <i class="like-btn-icon"></i>
                        <p class="react-name">Like</p>
                    </div>
                    <!--   </ng-template> -->
                    <div class="react-box">
                        <ng-container *ngFor="let src of srcReactIcons">
                            <img class="react-icon" #reactIconTemplateRef [src]="src.url" [alt]="src.name" (click)="
                  selectReactIcon($event, reactIconTemplateRef, src.name)
                " />
                        </ng-container>
                    </div>
                </li>
                <li class="react-btn__item" (click)="isShowComments = !isShowComments">
                    <div class="react-btn-wrap">
                        <i #likeBtnIconTemplateRef class="comment-btn-icon"></i>
                        <p>Comment</p>
                    </div>
                </li>
                <li class="react-btn__item">
                    <div class="react-btn-wrap">
                        <i #likeBtnIconTemplateRef class="shared-btn-icon"></i>
                        <p>Shared</p>
                    </div>
                </li>
            </ul>
        </div>
        <ng-container *ngIf="isShowComments">
            <div class="separate-line"></div>
            <div class="post-row">
                <img class="comment-avatar" src="assets/image/profile-pic.png" alt="" />
                <div class="comment-box bg-cl">
                    <input #post1Id type="text" placeholder="Write a comment..." />
                    <div class="activate">
                        <i class="emoji"></i>
                        <i class="photo"></i>
                        <i class="sticker"></i>
                    </div>
                </div>
            </div>
            <!-- comment tree -->
            <ul class="comment-list">
                <ng-container *ngFor="let comment of commentTree; index as i">
                    <ul class="comment-item">
                        <div class="comment-line parent-comment-line"></div>
                        <!-- Comment detail of parent-->
                        <div class="comment-detail comment-parent">
                            <div class="comment-detail__wrapper-img comment-detail__wrapper-img--parent">
                                <img src="assets/image/profile-pic.png" alt="" />
                            </div>
                            <div class="comment-detail__wrapper-info">
                                <div class="comment-detail__info comment-detail__info--background">
                                    <p class="">{{ comment.user.name }}</p>
                                    <div class="comment-content">{{ comment.content }}</div>
                                </div>
                                <div class="comment-detail__react">
                                    <div class="comment-detail__react-like">
                                        <div class="react-like">Like</div>
                                        <div class="react-box">
                                            <ng-container *ngFor="let src of srcReactIcons">
                                                <img [src]="src.url" alt="" />
                                            </ng-container>
                                        </div>
                                    </div>
                                    <div class="comment-detail__react-reply"
                                        (click)="onClickRepUser(comment.user.name, rootReplyInput)">
                                        Reply
                                    </div>
                                    <label class="comment-detail__react-time">11h</label>
                                </div>
                            </div>
                        </div>
                        <!-- Child comment -->
                        <ng-container *ngFor="let childComment of comment.comments">
                            <ul class="comment-item comment-child">
                                <div class="comment-line child-comment-line"></div>
                                <div class="comment-detail">
                                    <div class="comment-detail__wrapper-img comment-detail__wrapper-img--child">
                                        <div class="comment-link"></div>
                                        <img src="assets/image/profile-pic.png" alt="" />
                                    </div>
                                    <div class="comment-detail__wrapper-info">
                                        <div class="comment-detail__info comment-detail__info--background">
                                            <p class="">{{ childComment.user.name }}</p>
                                            <div class="comment-content">
                                                {{ childComment.content }}
                                            </div>
                                        </div>
                                        <div class="comment-detail__react">
                                            <div class="comment-detail__react-like">
                                                Like
                                                <div class="react-box">
                                                    <ng-container *ngFor="let src of srcReactIcons">
                                                        <img [src]="src.url" alt="" />
                                                    </ng-container>
                                                </div>
                                            </div>
                                            <div class="comment-detail__react-reply" (click)="
                          onClickRepUser(
                            childComment.user.name,
                            childReplyInput
                          )
                        ">
                                                Reply
                                            </div>
                                            <label class="comment-detail__react-time">11h</label>
                                        </div>
                                    </div>
                                </div>
                                <!-- Leaf child comment -->
                                <ng-container *ngFor="let c of childComment.comments">
                                    <li class="comment-item comment-sibling">
                                        <div class="comment-detail">
                                            <div class="comment-detail__wrapper-img comment-detail__wrapper-img--child">
                                                <div class="comment-link"></div>
                                                <img src="assets/image/profile-pic.png" alt="" />
                                            </div>
                                            <div class="comment-detail__wrapper-info">
                                                <div class="comment-detail__info comment-detail__info--background">
                                                    <p class="">{{ c.user.name }}</p>
                                                    <div class="comment-content">{{ c.content }}</div>
                                                </div>
                                                <div class="comment-detail__react">
                                                    <div class="comment-detail__react-like">
                                                        Like
                                                        <div class="react-box">
                                                            <ng-container *ngFor="let src of srcReactIcons">
                                                                <img [src]="src" alt="" />
                                                            </ng-container>
                                                        </div>
                                                    </div>
                                                    <div class="comment-detail__react-reply" (click)="
                              onClickRepUser(c.user.name, childReplyInput)
                            ">
                                                        Reply
                                                    </div>
                                                    <label class="comment-detail__react-time">11h</label>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ng-container>
                                <!-- COMMENT INPUT -->
                                <ul class="comment-item comment-sibling">
                                    <div class="comment-detail">
                                        <div class="comment-detail__wrapper-img comment-detail__wrapper-img--child">
                                            <div class="comment-link"></div>
                                            <img src="assets/image/profile-pic.png" alt="" />
                                        </div>
                                        <div class="comment-box bg-cl">
                                            <input #childReplyInput type="text" placeholder="Write a comment..." />
                                            <div class="activate">
                                                <i class="emoji"></i>
                                                <i class="photo"></i>
                                                <i class="sticker"></i>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                            </ul>
                        </ng-container>
                        <!-- COMMENT INPUT -->
                        <ul class="comment-item comment-child">
                            <div class="comment-detail">
                                <div class="comment-detail__wrapper-img comment-detail__wrapper-img--child">
                                    <div class="comment-link"></div>
                                    <img src="assets/image/profile-pic.png" alt="" />
                                </div>
                                <div class="comment-box bg-cl">
                                    <input #rootReplyInput type="text" placeholder="Write a comment..." />
                                    <div class="activate">
                                        <i class="emoji"></i>
                                        <i class="photo"></i>
                                        <i class="sticker"></i>
                                    </div>
                                </div>
                            </div>
                        </ul>
                    </ul>
                </ng-container>
                <div class="view-more-box d-flex justify-content-between align-items-center">
                    <p class="font-weight-600">View more comments</p>
                    <p>12 of 3,711</p>
                </div>
                <div class="write-a-comment d-flex justify-content-between align-items-center">
                    <p class="font-weight-600" (click)="navigateTo(post1Id)">
                        Write a comment...
                    </p>
                </div>
            </ul>
        </ng-container>
    </div>
    <button class="load-more-btn">Load more</button>
</div>